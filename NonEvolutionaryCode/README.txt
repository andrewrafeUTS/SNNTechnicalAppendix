This code was used for experiments in Chapter 6.
